#
# This file contains expected test output data generated by PBBT.
#
---
suite: rex.forms
tests:
- forms: test/forms/*.json
  validations:
  - {test/forms/bad_instrument.json: 'ValidationError: u''version'' is a required
      property'}
  - {test/forms/broken_instrument.json: 'ValidationError: Invalid Instrument JSON
      provided: No JSON object could be decoded'}
  - {test/forms/extra_element_options.json: 'ValidationError: "header" Element cannot
      have options: fieldId'}
  - {test/forms/extra_field.json: 'ValidationError: There are fields that are not
      in the Instrument: q_doesntexist'}
  - {test/forms/garbage.json: 'ValidationError: Invalid JSON provided: No JSON object
      could be decoded'}
  - {test/forms/instrument_not_an_object.json: 'ValidationError: Instrument Definitions
      must be mapped objects.'}
  - {test/forms/missing_defaultlocalization.json: 'ValidationError: u''defaultLocalization''
      is a required property'}
  - {test/forms/missing_element_options.json: 'ValidationError: "header" Element missing
      required options: text'}
  - {test/forms/missing_enumeration_help_localization.json: 'ValidationError: Enumeration
      help missing localization for en'}
  - {test/forms/missing_enumeration_localization.json: 'ValidationError: Enumeration
      text missing localization for en'}
  - {test/forms/missing_field.json: 'ValidationError: There are fields which have
      not be used: q_foobar'}
  - {test/forms/missing_field_error_localization.json: 'ValidationError: Element error
      missing localization for en'}
  - {test/forms/missing_field_help_localization.json: 'ValidationError: Element help
      missing localization for en'}
  - {test/forms/missing_field_localization.json: 'ValidationError: Element text missing
      localization for en'}
  - {test/forms/missing_instrument.json: 'ValidationError: u''instrument'' is a required
      property'}
  - {test/forms/missing_page_elements.json: 'ValidationError: u''elements'' is a required
      property'}
  - {test/forms/missing_page_id.json: 'ValidationError: u''id'' is a required property'}
  - {test/forms/missing_pages.json: 'ValidationError: u''pages'' is a required property'}
  - {test/forms/missing_title_localization.json: 'ValidationError: Form title missing
      localization for en'}
  - {test/forms/not_an_object.json: 'ValidationError: Form Configurations must be
      mapped objects.'}
  - {test/forms/repeat_field.json: 'ValidationError: Field "q_fake" is used by multiple
      questions'}
  - {test/forms/repeat_page.json: 'ValidationError: Page identifiers are used multiple
      times: page1'}
  - {test/forms/simplest.json: VALIDATED}
- suite: rex-forms-validate
  tests:
  - sh: rex forms-validate test/forms/simplest.json
    stdout: |+
      "test/forms/simplest.json" contains a valid Web Form Configuration.

  - sh: rex forms-validate test/forms/missing_pages.json
    stdout: |+
      FATAL ERROR: u'pages' is a required property

  - sh: rex forms-validate /tmp/does/not/actually/exist.json
    stdout: |+
      FATAL ERROR: Could not open "/tmp/does/not/actually/exist.json": [Errno 2] No such file or directory: '/tmp/does/not/actually/exist.json'

  - sh: rex forms-validate
    stdout: |+
      FATAL ERROR: missing argument <configuration>

- sh: pip install -q -e ./demo/rex.forms_demo
  stdout: ''
- sh: pip uninstall -q -y rex.forms_demo
  stdout: ''
